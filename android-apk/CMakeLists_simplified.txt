# Simplified CMakeLists.txt for Android build
cmake_minimum_required(VERSION 3.22.1)
project(sandbox_radar)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_FLAGS_RELEASE "-O3 -ffast-math -DNDEBUG")

option(ENABLE_60FPS "Enable 60 FPS interpolation" ON)

# 添加源码
add_library(
    sandbox_radar
    SHARED
    app/src/main/cpp/jni_interface.cc
    app/src/main/cpp/radiation.cc
    app/src/main/cpp/volcano.cc
    src/core/render_loop.cc
    src/core/sim_loop.cc
    src/interpolate/agent_lerp.cc
    src/interpolate/audio_lerp.cc
    src/interpolate/field_lerp.cc
    # 新增的高级微物理模块
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/micro/micro_advanced.cc
    # 新增的海洋-大气耦合器
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/coupler/ocean_atmosphere_coupler.cc
    # 新增的增强边界层模型
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/pbl/enhanced_pbl.cc
    # 新增的增强数据同化模块
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/assim/enhanced_assim.cc
    # 新增的雷达模拟模块
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/radar/radar_simulator.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/radar/radar_memory_pool.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/assim/enhanced_assim.cc
)
    # 原有的核心库文件
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/meteor_core.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/grid.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/micro.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/electrification.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/flash.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/nox.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/typhoon/typhoon.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/typhoon/beta_drift.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/typhoon/steering_flow.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/typhoon/terrain_deflect.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/audio/screen_space_audio.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/ui_interface.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/agent/agent.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/hydrology.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/ocean.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/vegetation.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/ice.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/chemistry.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/radiation.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/volcano.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/human.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/cosmic.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/ionosphere/ionosphere.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/carbon/carbon_cycle.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/urban/urban.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/lightning_chem/lightning_chem.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/urban_policy/urban_policy.cc
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/assim/enhanced_assim.cc
)

# 包含头文件路径
target_include_directories(
    sandbox_radar PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}/app/src/main/cpp
    ${CMAKE_CURRENT_SOURCE_DIR}/src
    ${CMAKE_CURRENT_SOURCE_DIR}/src/core
    ${CMAKE_CURRENT_SOURCE_DIR}/src/interpolate
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/micro
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/coupler
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/pbl
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/typhoon
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/agent
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/ionosphere
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/carbon
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/urban
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/lightning_chem
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/audio
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/assim
    ${CMAKE_CURRENT_SOURCE_DIR}/sandbox-radar/lib/radar
)

# 链接 Android NDK 提供的库
target_link_libraries(
    sandbox_radar
    log        # Android log
    android    # Android system API
)